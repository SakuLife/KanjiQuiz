# 統一スコアリングシステム

## 概要
動画パフォーマンスを0-100点で評価し、具体的な改善提案を生成する統一評価システムです。

## 主要機能

### 1. 統一スコア算出 (0-100点)
**重み付け設定:**
- 再生数: 60% (メイン指標)
- コメント数: 25% (エンゲージメント重視)
- コメント内容の質: 10% (将来拡張予定)
- いいね数: 5% (参考程度)

**評価方式:**
- 相対評価 (50%): チャンネル内での順位
- 絶対評価 (50%): 目標達成度

### 2. ランク付けシステム
- **S**: 優秀 (80点以上)
- **A**: 良好 (60-79点)
- **B**: 普通 (40-59点)
- **C**: 要改善 (20-39点)
- **D**: 大幅改善必要 (0-19点)

### 3. テーマ別難易度補正
```python
theme_difficulty_bonus = {
    '春': 1.0,      # 季節物は一般的
    '夏': 1.0,
    '秋': 1.0,
    '冬': 1.0,
    '食べ物': 1.1,   # やや人気
    '動物': 1.1,
    '難読漢字': 1.3, # 専門性が高い
    '魚へん': 1.2,   # ニッチ
    '虫へん': 1.4,   # かなりニッチ
    '不明': 1.0
}
```

### 4. チャンネル成長段階別目標
**Micro段階 (0-100フォロワー) - 現状**
- 目標再生数/動画: 50回
- 目標コメント数/動画: 2件
- 目標いいね数/動画: 3件

**Small段階 (100-1000フォロワー)**
- 目標再生数/動画: 200回
- 目標コメント数/動画: 8件
- 目標いいね数/動画: 15件

## 使用方法

### 個別動画分析
```python
from core.unified_scoring_system import UnifiedScoringSystem

scoring_system = UnifiedScoringSystem()
result = scoring_system.calculate_unified_score(
    video_data=video,
    all_videos=all_videos_list,
    channel_subscribers=50
)

print(f"スコア: {result['unified_score']}点")
print(f"ランク: {result['rank']}")
print(f"改善提案: {result['recommendations']}")
```

### チャンネル全体分析
```python
channel_analysis = scoring_system.analyze_channel_performance(
    all_videos=all_videos_list,
    channel_subscribers=50
)

print(f"平均スコア: {channel_analysis['average_score']}点")
print(f"ランク分布: {channel_analysis['rank_distribution']}")
print(f"トップパフォーマー: {channel_analysis['top_performers']}")
```

## 自動統合

### Reporter.py統合
- 週次レポートで全体分析結果を表示
- 個別動画分析時にスコアを算出
- Discord通知にスコア情報を追加

### Discord通知内容
**個別動画分析**
```
📈 日次分析レポート 📈

動画タイトル: 春の漢字クイズ
https://www.youtube.com/watch?v=...

【統計情報】
- 再生数: 100 回
- 高評価: 5 件
- コメント: 3 件

【統一スコア評価】
- 総合スコア: 65.2点/100 (ランク: A)
- 内訳: 再生数 60.0点 | コメント 70.0点 | 内容評価 50.0点
- 改善提案: タイトルをより興味を引くものに変更
```

**週次レポート**
```
📈 チャンネル週次レポート 📈

【統一スコア分析】
- チャンネル平均: 58.3点/100
- ランク分布: S:1 A:3 B:2 C:1 D:0
- 最高スコア: 78.5点 (虫へんの超難読漢字...)
- 改善提案: 高パフォーマンステーマ「虫へん」の動画を増やす
```

## テスト実行

```bash
# 統一スコアリングシステムのテスト
python -m pytest tests/test_unified_scoring.py -v

# 全体テスト（既存のreporterテストも含む）
python -m pytest tests/ -v
```

## 改善提案の種類

### 再生数向上
- タイトルの魅力度向上
- サムネイル改善
- より専門性の高いテーマ選択

### エンゲージメント向上
- 視聴者との対話促進
- コメント欄活性化
- 議論を呼ぶ問題の追加

### 解説品質向上
- 文字数の最適化（30-50文字推奨）
- 豆知識の充実
- テンポの改善

## ログ出力

全ての分析過程がログに記録されます：
```
INFO: 統一スコアリング分析完了: 平均スコア 58.3点
INFO: テーマ別分析: 虫へん(avg:72.1) > 食べ物(avg:65.2) > 春(avg:58.0)
INFO: 改善提案生成: 3件の具体的提案を生成
```

## 今後の拡張予定

1. **コメント内容分析**
   - ポジティブ/ネガティブ判定
   - 建設的フィードバック検出
   - 視聴者満足度評価

2. **時系列分析**
   - 成長トレンド追跡
   - 季節性分析
   - パフォーマンス予測

3. **競合分析**
   - 同ジャンル動画との比較
   - 業界標準との対比
   - ベンチマーク設定

## トラブルシューティング

### よくある問題

**Q: スコアが算出されない**
A: 以下を確認してください：
- 動画の再生数が1以上
- スクリプトデータが正しいJSON形式
- latest_statsが設定されている

**Q: テーマボーナスが適用されない**
A: スクリプトのthemeフィールドを確認してください。不明な場合はタイトルから推測されます。

**Q: 改善提案が生成されない**
A: スコアが十分高い場合は提案が少なくなります。これは正常な動作です。